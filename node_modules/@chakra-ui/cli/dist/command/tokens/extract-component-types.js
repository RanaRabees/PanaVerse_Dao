"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.extractComponentTypes = extractComponentTypes;
exports.printComponentTypes = printComponentTypes;

var _isObject = require("../../utils/is-object");

var _extractPropertyPaths = require("./extract-property-paths");

function extractComponentTypes(theme) {
  const components = theme.components;

  if (!(0, _isObject.isObject)(components)) {
    return {};
  }

  return Object.entries(components).reduce((allDefs, [componentName, definition]) => {
    if (definition) {
      allDefs[componentName] = {
        sizes: Object.keys(definition.sizes ?? {}),
        variants: Object.keys(definition.variants ?? {})
      };
    }

    return allDefs;
  }, {});
}

function escapeComponentName(componentName) {
  return componentName.match(/^[a-zA-Z0-9\-_]+$/) ? componentName : `"${componentName}"`;
}

function printComponentTypes(componentTypes, strict = false) {
  const types = Object.entries(componentTypes).map(([componentName, unions]) => `${escapeComponentName(componentName)}: {
  ${(0, _extractPropertyPaths.printUnionMap)(unions, strict)}
}`).join(`
`);
  return `components: {
  ${types}  
}
`;
}